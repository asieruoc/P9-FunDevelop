<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUN CONQUEST</title>
    <!--BOOTSTRAP-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="scripts/webstorage.js"></script>
    <!--CSS-->
    <link rel="stylesheet" href="./css/estilos.css">
</head>
<body onload="loadUserData()">
<div class="container-fluid backgroundHome">
    <!-- Contenido-->
    <div class="container bg-light opacity-90 containerFormat col-md-5">
        <div class="labelTitulo">
            <label><img src="/img/banderas.png">Entra y conquista el mundo.</label>
        </div>
        <form id="userLogin" action="/salas" method="post">
            </br>
            <div class="form-group">
                <label for="inputName">NOMBRE:</label>
                <input type="text" class="form-control" id="inputName" name="playerName" placeholder="Entra tu nombre">
            </div>
            </br>
            <div class="form-group">
                <label for="">AVATAR:</label>
            </div>
            </br>
            <div class="form-check">
                <div class="layout-box">
                    <div class="row">
                        <div class="col-md-2 col-sm-2"><img src="/img/Avatar1.png" class="layout-image">
                            <div class="radio radio-adjust">
                                <label><input type="radio" name="avatar-radio" value="1"></label>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2"><img src="/img/Avatar2.png" class="layout-image">
                            <div class="radio radio-adjust">
                                <label><input type="radio" name="avatar-radio" value="2"></label>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2"><img src="/img/Avatar3.png" class="layout-image">
                            <div class="radio radio-adjust">
                                <label><input type="radio" name="avatar-radio" value="3"></label>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2"><img src="/img/Avatar4.png" class="layout-image">
                            <div class="radio radio-adjust">
                                <label><input type="radio" name="avatar-radio" value="4"></label>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2"><img src="/img/Avatar5.png" class="layout-image">
                            <div class="radio radio-adjust">
                                <label><input type="radio" name="avatar-radio" value="5"></label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </br>
            <div class="text-center">
                <button type="button" class="btn btn-primary" onclick="sendForm()">Entrar</button>
            </div>
        </form>
    </div>
</div>

<script>

    function loadUserData() {
        if(localStorage.getItem("userData")){
            var userPrefs = JSON.parse(localStorage.getItem("userData"));
            document.getElementById("inputName").value = userPrefs.username;
            var radios = document.getElementsByName('avatar-radio');
            var radioPos = userPrefs.avatar - 1;
            radios[radioPos].checked = true;
        }
    }


    function sendForm() {
        var form = document.getElementById("userLogin");

        var username = document.getElementById("inputName").value;

        var radios = document.getElementsByName('avatar-radio');
        var found = false;
        var i = 0;
        var avatar = 0;
        while(i < radios.length && !found) {
            if (radios[i].checked) {
                // do whatever you want with the checked radio
                avatar = radios[i].value;
                found = true;
            }
            i++;
        }

        var userPrefs = {username: username, avatar: avatar};

        localStorage.setItem("userData", JSON.stringify(userPrefs));

        form.submit();
    }

</script>
</body>
</html>